#include "ui_helper.h"
#include <stdint.h>
/*************************************************************************************/
/*                                  CONSTANT DEFINE                                  */
/*************************************************************************************/
   
/*************************************************************************************/
/*                                    MODULE TYPE                                    */
/*************************************************************************************/

/*************************************************************************************/
/*                                  MODULE VARIABLE                                  */
/*************************************************************************************/

/*************************************************************************************/
/*                            PRIVATE FUNCTION PROTOTYPE                             */
/*************************************************************************************/

/*************************************************************************************/
/*                                  PUBLIC FUNCTION                                  */
/*************************************************************************************/
uint32_t ui_calc_crc32(uint8_t * buf, uint32_t len)
{
  static uint8_t  is_table_generated = 0x0;
  static uint32_t crc32_table[256];
  if(!is_table_generated)
  {
  	for(uint32_t i = 0; i < 256; i++) 
    {
      uint32_t ch = i;
      uint32_t crc = 0;
      for(uint32_t j = 0; j < 8; j++) 
      {
        uint32_t b = (ch ^ crc) & 1;
        crc >>= 1;
        if(b) crc = crc ^ 0xEDB88320;
        ch >>= 1;
      }
      crc32_table[i] = crc;
	  }
    is_table_generated = 0x1;
  }

  uint32_t ret_crc = 0xFFFFFFFF;
	for(uint32_t i = 0; i < len; i++) 
  {
		char single_byte = buf[i];
		uint32_t t = (single_byte ^ ret_crc) & 0xFF;
		ret_crc = (ret_crc >> 8) ^ crc32_table[t];
	}
	return ~ret_crc;
}

/*************************************************************************************/
/*                                 PRIVATE FUNCTION                                  */
/*************************************************************************************/


